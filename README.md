quickly hacked together, but it works.

Now with repacking!
